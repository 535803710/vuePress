<!DOCTYPE html>
<html lang="en-US">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>前端小蜗</title>
    <meta name="generator" content="VuePress 1.9.7">
    <link rel="icon" href="/vuepress/img/home.jpeg">
    <meta name="description" content="Just playing around">
    
    <link rel="preload" href="/vuepress/assets/css/0.styles.189cad16.css" as="style"><link rel="preload" href="/vuepress/assets/js/app.40312837.js" as="script"><link rel="preload" href="/vuepress/assets/js/2.cf1e524c.js" as="script"><link rel="preload" href="/vuepress/assets/js/31.11915659.js" as="script"><link rel="prefetch" href="/vuepress/assets/js/10.a610a9ba.js"><link rel="prefetch" href="/vuepress/assets/js/11.f87d06bd.js"><link rel="prefetch" href="/vuepress/assets/js/12.11a58652.js"><link rel="prefetch" href="/vuepress/assets/js/13.110f8559.js"><link rel="prefetch" href="/vuepress/assets/js/14.322c46a5.js"><link rel="prefetch" href="/vuepress/assets/js/15.b2b443b5.js"><link rel="prefetch" href="/vuepress/assets/js/16.7ff17cba.js"><link rel="prefetch" href="/vuepress/assets/js/17.fc193e79.js"><link rel="prefetch" href="/vuepress/assets/js/18.52d0a4c4.js"><link rel="prefetch" href="/vuepress/assets/js/19.25f2d672.js"><link rel="prefetch" href="/vuepress/assets/js/20.c6723148.js"><link rel="prefetch" href="/vuepress/assets/js/21.74e5c0f6.js"><link rel="prefetch" href="/vuepress/assets/js/22.e6d1a64a.js"><link rel="prefetch" href="/vuepress/assets/js/23.86aba3c2.js"><link rel="prefetch" href="/vuepress/assets/js/24.3ae19470.js"><link rel="prefetch" href="/vuepress/assets/js/25.edcf91c9.js"><link rel="prefetch" href="/vuepress/assets/js/26.89319ef2.js"><link rel="prefetch" href="/vuepress/assets/js/27.9e533376.js"><link rel="prefetch" href="/vuepress/assets/js/28.93a6ba41.js"><link rel="prefetch" href="/vuepress/assets/js/29.d72f0022.js"><link rel="prefetch" href="/vuepress/assets/js/3.a5adedeb.js"><link rel="prefetch" href="/vuepress/assets/js/30.871cc77c.js"><link rel="prefetch" href="/vuepress/assets/js/32.2d371a40.js"><link rel="prefetch" href="/vuepress/assets/js/33.19d049e9.js"><link rel="prefetch" href="/vuepress/assets/js/34.52633d55.js"><link rel="prefetch" href="/vuepress/assets/js/35.c77625e0.js"><link rel="prefetch" href="/vuepress/assets/js/36.ec517178.js"><link rel="prefetch" href="/vuepress/assets/js/37.e955d687.js"><link rel="prefetch" href="/vuepress/assets/js/38.a76e9c38.js"><link rel="prefetch" href="/vuepress/assets/js/39.0758c6eb.js"><link rel="prefetch" href="/vuepress/assets/js/4.7fc56b7b.js"><link rel="prefetch" href="/vuepress/assets/js/40.bfc21b26.js"><link rel="prefetch" href="/vuepress/assets/js/41.1cca45c8.js"><link rel="prefetch" href="/vuepress/assets/js/42.76b92fb2.js"><link rel="prefetch" href="/vuepress/assets/js/43.5bcb4c47.js"><link rel="prefetch" href="/vuepress/assets/js/44.0bf86704.js"><link rel="prefetch" href="/vuepress/assets/js/45.b6f1d2ae.js"><link rel="prefetch" href="/vuepress/assets/js/46.d942ba15.js"><link rel="prefetch" href="/vuepress/assets/js/47.8bb95ad0.js"><link rel="prefetch" href="/vuepress/assets/js/48.fb8ad7c2.js"><link rel="prefetch" href="/vuepress/assets/js/49.fb46b14b.js"><link rel="prefetch" href="/vuepress/assets/js/5.6ac62750.js"><link rel="prefetch" href="/vuepress/assets/js/50.49f08253.js"><link rel="prefetch" href="/vuepress/assets/js/51.7663b0cd.js"><link rel="prefetch" href="/vuepress/assets/js/52.90d8fc5a.js"><link rel="prefetch" href="/vuepress/assets/js/53.00bdcc76.js"><link rel="prefetch" href="/vuepress/assets/js/54.93e18111.js"><link rel="prefetch" href="/vuepress/assets/js/55.c887fc69.js"><link rel="prefetch" href="/vuepress/assets/js/56.0f6408ae.js"><link rel="prefetch" href="/vuepress/assets/js/57.e8334a13.js"><link rel="prefetch" href="/vuepress/assets/js/58.52393270.js"><link rel="prefetch" href="/vuepress/assets/js/59.d0661709.js"><link rel="prefetch" href="/vuepress/assets/js/6.d831054f.js"><link rel="prefetch" href="/vuepress/assets/js/60.0b34950f.js"><link rel="prefetch" href="/vuepress/assets/js/61.13e9f684.js"><link rel="prefetch" href="/vuepress/assets/js/62.caee8c5c.js"><link rel="prefetch" href="/vuepress/assets/js/63.a22fbd8d.js"><link rel="prefetch" href="/vuepress/assets/js/64.d8204a06.js"><link rel="prefetch" href="/vuepress/assets/js/65.4d094f10.js"><link rel="prefetch" href="/vuepress/assets/js/66.b4582d16.js"><link rel="prefetch" href="/vuepress/assets/js/67.93aa23db.js"><link rel="prefetch" href="/vuepress/assets/js/68.b57ddd04.js"><link rel="prefetch" href="/vuepress/assets/js/69.83923766.js"><link rel="prefetch" href="/vuepress/assets/js/7.b60f99e7.js"><link rel="prefetch" href="/vuepress/assets/js/70.39d4195c.js"><link rel="prefetch" href="/vuepress/assets/js/71.e28be685.js"><link rel="prefetch" href="/vuepress/assets/js/72.e068c5cc.js"><link rel="prefetch" href="/vuepress/assets/js/73.3c5972cf.js"><link rel="prefetch" href="/vuepress/assets/js/74.2c300814.js"><link rel="prefetch" href="/vuepress/assets/js/75.16887871.js"><link rel="prefetch" href="/vuepress/assets/js/76.aef8e41e.js"><link rel="prefetch" href="/vuepress/assets/js/77.11355457.js"><link rel="prefetch" href="/vuepress/assets/js/78.d6a93a91.js"><link rel="prefetch" href="/vuepress/assets/js/79.394993f0.js"><link rel="prefetch" href="/vuepress/assets/js/8.affe4fa6.js"><link rel="prefetch" href="/vuepress/assets/js/80.60f3a775.js"><link rel="prefetch" href="/vuepress/assets/js/81.25fbce38.js"><link rel="prefetch" href="/vuepress/assets/js/82.beae6628.js"><link rel="prefetch" href="/vuepress/assets/js/83.3bd6257a.js"><link rel="prefetch" href="/vuepress/assets/js/84.851ad369.js"><link rel="prefetch" href="/vuepress/assets/js/85.8ddf405f.js"><link rel="prefetch" href="/vuepress/assets/js/86.8fcd8b07.js"><link rel="prefetch" href="/vuepress/assets/js/87.5d4b02bf.js"><link rel="prefetch" href="/vuepress/assets/js/88.e523ea38.js"><link rel="prefetch" href="/vuepress/assets/js/89.89ebef39.js"><link rel="prefetch" href="/vuepress/assets/js/9.a4881f71.js">
    <link rel="stylesheet" href="/vuepress/assets/css/0.styles.189cad16.css">
  </head>
  <body>
    <div id="app" data-server-rendered="true"><div class="theme-container"><header class="navbar"><div class="sidebar-button"><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" role="img" viewBox="0 0 448 512" class="icon"><path fill="currentColor" d="M436 124H12c-6.627 0-12-5.373-12-12V80c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12zm0 160H12c-6.627 0-12-5.373-12-12v-32c0-6.627 5.373-12 12-12h424c6.627 0 12 5.373 12 12v32c0 6.627-5.373 12-12 12z"></path></svg></div> <a href="/vuepress/" class="home-link router-link-active"><img src="/vuepress/img/home.jpeg" alt="前端小蜗" class="logo"> <span class="site-name can-hide">前端小蜗</span></a> <div class="links"><div class="search-box"><input aria-label="Search" autocomplete="off" spellcheck="false" value=""> <!----></div> <nav class="nav-links can-hide"><div class="nav-item"><a href="/vuepress/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/vuepress/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><a href="https://f2e.tech/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端学习路径
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://roadmap.sh/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  学习路线图
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://juejin.cn/user/61995432544503" target="_blank" rel="noopener noreferrer" class="nav-link external">
  我的其他文章
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav></div></header> <div class="sidebar-mask"></div> <aside class="sidebar"><nav class="nav-links"><div class="nav-item"><a href="/vuepress/" class="nav-link">
  首页
</a></div><div class="nav-item"><a href="/vuepress/guide/" class="nav-link">
  指南
</a></div><div class="nav-item"><a href="https://f2e.tech/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  前端学习路径
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://roadmap.sh/" target="_blank" rel="noopener noreferrer" class="nav-link external">
  学习路线图
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div><div class="nav-item"><a href="https://juejin.cn/user/61995432544503" target="_blank" rel="noopener noreferrer" class="nav-link external">
  我的其他文章
  <span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" x="0px" y="0px" viewBox="0 0 100 100" width="15" height="15" class="icon outbound"><path fill="currentColor" d="M18.8,85.1h56l0,0c2.2,0,4-1.8,4-4v-32h-8v28h-48v-48h28v-8h-32l0,0c-2.2,0-4,1.8-4,4v56C14.8,83.3,16.6,85.1,18.8,85.1z"></path> <polygon fill="currentColor" points="45.7,48.7 51.3,54.3 77.2,28.5 77.2,37.2 85.2,37.2 85.2,14.9 62.8,14.9 62.8,22.9 71.5,22.9"></polygon></svg> <span class="sr-only">(opens new window)</span></span></a></div> <!----></nav>  <ul class="sidebar-links"><li><a href="/vuepress/guide/" class="sidebar-link">介绍</a></li><li><section class="sidebar-group collapsable depth-0"><a href="/vuepress/JS基础/" class="sidebar-heading clickable"><span>JS基础</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/vuepress/小程序/" class="sidebar-heading clickable"><span>小程序</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/vuepress/浏览器/" class="sidebar-heading clickable"><span>浏览器</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/vuepress/HTTP/" class="sidebar-heading clickable"><span>HTTP</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/vuepress/Node/拦截器/" class="sidebar-heading clickable"><span>Node</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/vuepress/Vue/vue" class="sidebar-heading clickable"><span>Vue</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/vuepress/React/" class="sidebar-heading clickable router-link-active open"><span>React</span> <span class="arrow down"></span></a> <ul class="sidebar-links sidebar-group-items"><li><a href="/vuepress/React/JSX/" class="sidebar-link">JSX</a></li><li><a href="/vuepress/React/React%20%E5%9F%BA%E7%A1%80/" aria-current="page" class="active sidebar-link">React 基础</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress/React/React%20%E5%9F%BA%E7%A1%80/#那么-函数组件和类组件本质的区别是什么呢" class="sidebar-link">那么，函数组件和类组件本质的区别是什么呢？</a></li><li class="sidebar-sub-header"><a href="/vuepress/React/React%20%E5%9F%BA%E7%A1%80/#组件通信方式" class="sidebar-link">组件通信方式</a></li><li class="sidebar-sub-header"><a href="/vuepress/React/React%20%E5%9F%BA%E7%A1%80/#usestate-原理" class="sidebar-link">useState 原理</a><ul class="sidebar-sub-headers"><li class="sidebar-sub-header"><a href="/vuepress/React/React%20%E5%9F%BA%E7%A1%80/#componentdidmount-替代方案" class="sidebar-link">componentDidMount 替代方案</a></li><li class="sidebar-sub-header"><a href="/vuepress/React/React%20%E5%9F%BA%E7%A1%80/#componentwillunmount-替代方案" class="sidebar-link">componentWillUnmount 替代方案</a></li><li class="sidebar-sub-header"><a href="/vuepress/React/React%20%E5%9F%BA%E7%A1%80/#componentwillreceiveprops-替代方案" class="sidebar-link">componentWillReceiveProps 替代方案</a></li><li class="sidebar-sub-header"><a href="/vuepress/React/React%20%E5%9F%BA%E7%A1%80/#componentdidupdate-替代方案" class="sidebar-link">componentDidUpdate 替代方案</a></li></ul></li><li class="sidebar-sub-header"><a href="/vuepress/React/React%20%E5%9F%BA%E7%A1%80/#forwardref-转发-ref-解决-ref-不能跨层级捕获和传递的问题。" class="sidebar-link">forwardRef 转发 Ref 解决 ref 不能跨层级捕获和传递的问题。</a></li><li class="sidebar-sub-header"><a href="/vuepress/React/React%20%E5%9F%BA%E7%A1%80/#函数组件-forwardref-useimperativehandle" class="sidebar-link">函数组件 forwardRef + useImperativeHandle</a></li><li class="sidebar-sub-header"><a href="/vuepress/React/React%20%E5%9F%BA%E7%A1%80/#逻辑流程图" class="sidebar-link">逻辑流程图</a></li></ul></li><li><a href="/vuepress/React/React%20%E6%9E%B6%E6%9E%84/" class="sidebar-link">React 架构 （数据更新流程设计）</a></li><li><a href="/vuepress/React/React%20%E5%AE%9E%E8%B7%B5/" class="sidebar-link">React 实践 （自定义hooks）</a></li><li><a href="/vuepress/React/React%20%E5%8E%9F%E7%90%86/" class="sidebar-link">React 原理 （hooks 原理）</a></li><li><a href="/vuepress/React/React%20%E4%BC%98%E5%8C%96/" class="sidebar-link">React 优化 （渲染控制）</a></li></ul></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/vuepress/算法/常见算法/" class="sidebar-heading clickable"><span>算法</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/vuepress/工程体系/" class="sidebar-heading clickable"><span>前端工程化</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/vuepress/最佳实践/" class="sidebar-heading clickable"><span>最佳实践</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/vuepress/TS指南/" class="sidebar-heading clickable"><span>TypeScrpit</span> <span class="arrow right"></span></a> <!----></section></li><li><section class="sidebar-group collapsable depth-0"><a href="/vuepress/心得/" class="sidebar-heading clickable"><span>心得体会</span> <span class="arrow right"></span></a> <!----></section></li></ul> </aside> <main class="page"> <div class="theme-default-content content__default"><ul><li><a href="#%E4%BB%80%E4%B9%88%E6%98%AF-react-%E7%BB%84%E4%BB%B6">什么是 React 组件</a> <ul><li><a href="#%E9%82%A3%E4%B9%88%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6%E5%92%8C%E7%B1%BB%E7%BB%84%E4%BB%B6%E6%9C%AC%E8%B4%A8%E7%9A%84%E5%8C%BA%E5%88%AB%E6%98%AF%E4%BB%80%E4%B9%88%E5%91%A2">那么，<strong>函数组件</strong>和<strong>类组件</strong>本质的区别是什么呢？</a></li> <li><a href="#%E7%BB%84%E4%BB%B6%E9%80%9A%E4%BF%A1%E6%96%B9%E5%BC%8F">组件通信方式</a></li></ul></li> <li><a href="#state">State</a> <ul><li><a href="#usestate-%E5%8E%9F%E7%90%86">useState 原理</a></li></ul></li> <li><a href="#props">Props</a></li> <li><a href="#lifecycle">lifeCycle</a> <ul><li><a href="#componentdidmount-%E6%9B%BF%E4%BB%A3%E6%96%B9%E6%A1%88">componentDidMount 替代方案</a></li> <li><a href="#componentwillunmount-%E6%9B%BF%E4%BB%A3%E6%96%B9%E6%A1%88">componentWillUnmount 替代方案</a></li> <li><a href="#componentwillreceiveprops-%E6%9B%BF%E4%BB%A3%E6%96%B9%E6%A1%88">componentWillReceiveProps 替代方案</a></li> <li><a href="#componentdidupdate-%E6%9B%BF%E4%BB%A3%E6%96%B9%E6%A1%88">componentDidUpdate 替代方案</a></li></ul></li> <li><a href="#ref">Ref</a> <ul><li><a href="#forwardref-%E8%BD%AC%E5%8F%91-ref-%E8%A7%A3%E5%86%B3-ref-%E4%B8%8D%E8%83%BD%E8%B7%A8%E5%B1%82%E7%BA%A7%E6%8D%95%E8%8E%B7%E5%92%8C%E4%BC%A0%E9%80%92%E7%9A%84%E9%97%AE%E9%A2%98">forwardRef 转发 Ref 解决 ref 不能跨层级捕获和传递的问题。</a></li> <li><a href="#%E5%87%BD%E6%95%B0%E7%BB%84%E4%BB%B6-forwardref--useimperativehandle">函数组件 forwardRef + useImperativeHandle</a></li> <li><a href="#%E9%80%BB%E8%BE%91%E6%B5%81%E7%A8%8B%E5%9B%BE">逻辑流程图</a></li></ul></li> <li><a href="#context">Context</a></li> <li><a href="#%E6%A8%A1%E5%9D%97%E5%8C%96-css">模块化 CSS</a></li> <li><a href="#hoc">HOC</a></li></ul> <h1 id="什么是-react-组件"><a href="#什么是-react-组件" class="header-anchor">#</a> 什么是 React 组件</h1> <p>组件本质上就是类和函数，不同的是组件承载了渲染视图的 UI 和更新视图的 setState 、 useState 等方法。</p> <p>React 组件本质——
<strong>UI + update + 常规的类和函数 = React 组件</strong></p> <h2 id="那么-函数组件和类组件本质的区别是什么呢"><a href="#那么-函数组件和类组件本质的区别是什么呢" class="header-anchor">#</a> 那么，<strong>函数组件</strong>和<strong>类组件</strong>本质的区别是什么呢？</h2> <ul><li><p>对于类组件来说，底层只需要实例化一次，实例中保存了组件的 state 等状态。对于每一次更新只需要调用 render 方法以及对应的生命周期就可以了。</p></li> <li><p>但是在函数组件中，每一次更新都是一次新的函数执行，一次函数组件的更新，里面的变量会重新声明。</p></li></ul> <h2 id="组件通信方式"><a href="#组件通信方式" class="header-anchor">#</a> 组件通信方式</h2> <ol><li>props 和 callback 方式
<ol><li>父组件 -&gt; 通过自身 state 改变，重新渲染，传递 props -&gt; 通知子组件</li> <li>子组件 -&gt; 通过调用父组件 props 方法 -&gt; 通知父组件。</li></ol></li> <li>ref 方式。</li> <li>React-redux 或 React-mobx 状态管理方式。</li> <li>context 上下文方式。</li> <li>event bus 事件总线。
<ol><li>致命缺点</li> <li>需要手动绑定和解绑。</li> <li>对于小型项目还好，但是对于中大型项目，这种方式的组件通信，会造成牵一发动全身的影响，而且后期难以维护，组件之间的状态也是未知的。</li> <li>一定程度上违背了 React 数据流向原则。</li></ol></li></ol> <h1 id="state"><a href="#state" class="header-anchor">#</a> State</h1> <p>state 到底是同步还是异步的？
回答出 batchUpdate 批量更新概念，以及批量更新被打破的条件。</p> <p>dispatch 更新特点</p> <ul><li>函数组件更新就是函数的执行，在函数一次执行过程中，函数内部所有变量重新声明，所以改变的 state ，只有在下一次函数组件执行时才会被更新。</li> <li>不要传入相同的 state，会导致视图不更新<div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> <span class="token function-variable function">handleClick</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">// 点击按钮，视图没有更新。</span>
  state<span class="token punctuation">.</span>name <span class="token operator">=</span> <span class="token string">&quot;Alien&quot;</span><span class="token punctuation">;</span>
  <span class="token function">dispatchState</span><span class="token punctuation">(</span>state<span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 直接改变 `state`，在内存中指向的地址相同。</span>
  <span class="token function">dispatchState</span><span class="token punctuation">(</span><span class="token punctuation">{</span> <span class="token operator">...</span>state <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 重新分配内存空间</span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
</code></pre></div></li></ul> <h2 id="usestate-原理"><a href="#usestate-原理" class="header-anchor">#</a> useState 原理</h2> <p><a href="/vuepress/React/React 原理/#状态派发-usestate-原理">useState 原理</a></p> <p>setState 和 useState 有什么异同？</p> <p><strong>相同点：</strong></p> <ul><li>首先从原理角度出发，setState 和 useState 更新视图，底层都调用了 scheduleUpdateOnFiber 方法，而且事件驱动情况下都有批量更新规则。</li></ul> <p><strong>不同点：</strong></p> <ul><li>在不是 pureComponent 组件模式下， setState 不会浅比较两次 state 的值，只要调用 setState，在没有其他优化手段的前提下，就会执行更新。但是 useState 中的 dispatchAction 会默认比较两次 state 是否相同，然后决定是否更新组件。</li> <li>setState 有专门监听 state 变化的回调函数 callback，可以获取最新 state；但是在函数组件中，只能通过 useEffect 来执行 state 变化引起的副作用。</li> <li>setState 在底层处理逻辑上主要是和老 state 进行合并处理，而 useState 更倾向于重新赋值。</li></ul> <h1 id="props"><a href="#props" class="header-anchor">#</a> Props</h1> <p>什么是 props ？</p> <p>无论是函数组件还是类组件 父组件在子组件的标签里绑定的属性或者方法 最终都会变成 props 传给子组件</p> <p>props 可以是什么？</p> <ol><li>props 作为一个子组件渲染数据源。</li> <li>props 作为一个通知父组件的回调函数。</li> <li>props 作为一个单纯的组件传递。</li> <li>props 作为渲染函数。</li> <li>render props ， 和 ④ 的区别是放在了 children 属性上。</li> <li>render component 插槽组件。</li></ol> <p>隐式注入 props</p> <div class="language-js extra-class"><pre class="language-js"><code>React<span class="token punctuation">.</span><span class="token function">cloneElement</span><span class="token punctuation">(</span>prop<span class="token punctuation">.</span>children<span class="token punctuation">,</span> <span class="token punctuation">{</span> <span class="token literal-property property">mes</span><span class="token operator">:</span> <span class="token string">&quot;let us learn React !&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h1 id="lifecycle"><a href="#lifecycle" class="header-anchor">#</a> lifeCycle</h1> <p><img src="https://pub-a953275fa2c34c18b80fc1f84e3ea746.r2.dev/xiaowo/2024/06/cde33557412f13a7f6b331460145300f.png" alt=""></p> <p>一句话概括如何选择 <strong>useEffect</strong> 和 <strong>useLayoutEffect</strong> ：修改 DOM ，改变布局就用 useLayoutEffect ，其他情况就用 useEffect 。</p> <p>执行顺序
useInsertionEffect &gt; useLayoutEffect &gt; useEffect</p> <p>｜--------问与答---------｜</p> <p>问：React.useEffect 回调函数 和 componentDidMount / componentDidUpdate 执行时机有什么区别 ？</p> <p>答：useEffect 对 React 执行栈来看是异步执行的，而 componentDidMount / componentDidUpdate 是同步执行的，useEffect 代码不会阻塞浏览器绘制。在时机上 ，componentDidMount / componentDidUpdate 和 useLayoutEffect 更类似。</p> <p>｜---------end----------｜</p> <h3 id="componentdidmount-替代方案"><a href="#componentdidmount-替代方案" class="header-anchor">#</a> componentDidMount 替代方案</h3> <div class="language-js extra-class"><pre class="language-js"><code>React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">/* 请求数据 ， 事件监听 ， 操纵dom */</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 切记 dep = [] */</span>
</code></pre></div><h3 id="componentwillunmount-替代方案"><a href="#componentwillunmount-替代方案" class="header-anchor">#</a> componentWillUnmount 替代方案</h3> <div class="language-js extra-class"><pre class="language-js"><code>React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  <span class="token comment">/* 请求数据 ， 事件监听 ， 操纵dom ， 增加定时器，延时器 */</span>
  <span class="token keyword">return</span> <span class="token keyword">function</span> <span class="token function">componentWillUnmount</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token comment">/* 解除事件监听器 ，清除定时器，延时器 */</span>
  <span class="token punctuation">}</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span><span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 切记 dep = [] */</span>
</code></pre></div><h3 id="componentwillreceiveprops-替代方案"><a href="#componentwillreceiveprops-替代方案" class="header-anchor">#</a> componentWillReceiveProps 替代方案</h3> <ul><li>首先因为二者的执行阶段根本不同，一个是在 render 阶段，一个是在 commit 阶段。</li> <li>其次 useEffect 会初始化执行一次，但是 componentWillReceiveProps 只有组件更新 props 变化的时候才会执行。</li></ul> <div class="language-js extra-class"><pre class="language-js"><code>React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;props变化：componentWillReceiveProps&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">[</span>props<span class="token punctuation">]</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div><h3 id="componentdidupdate-替代方案"><a href="#componentdidupdate-替代方案" class="header-anchor">#</a> componentDidUpdate 替代方案</h3> <p>useEffect 是异步执行，componentDidUpdate 是同步执行 ，但都是在 commit 阶段 。</p> <div class="language-js extra-class"><pre class="language-js"><code>React<span class="token punctuation">.</span><span class="token function">useEffect</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
  console<span class="token punctuation">.</span><span class="token function">log</span><span class="token punctuation">(</span><span class="token string">&quot;组件更新完成：componentDidUpdate &quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">/* 没有 dep 依赖项 */</span>
</code></pre></div><h1 id="ref"><a href="#ref" class="header-anchor">#</a> Ref</h1> <div class="language-js extra-class"><pre class="language-js"><code><span class="token punctuation">{</span>
    <span class="token literal-property property">current</span><span class="token operator">:</span><span class="token keyword">null</span> <span class="token punctuation">,</span> <span class="token comment">// current指向ref对象获取到的实际内容，可以是dom元素，组件实例，或者其它。</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="forwardref-转发-ref-解决-ref-不能跨层级捕获和传递的问题。"><a href="#forwardref-转发-ref-解决-ref-不能跨层级捕获和传递的问题。" class="header-anchor">#</a> forwardRef 转发 Ref 解决 ref 不能跨层级捕获和传递的问题。</h2> <p><strong>forwardRef</strong> 的初衷就是解决 ref 不能跨层级捕获和传递的问题。</p> <h2 id="函数组件-forwardref-useimperativehandle"><a href="#函数组件-forwardref-useimperativehandle" class="header-anchor">#</a> 函数组件 forwardRef + useImperativeHandle</h2> <p>对于函数组件，本身是没有实例的，但是 React Hooks 提供了，useImperativeHandle 一方面第一个参数接受父组件传递的 ref 对象，另一方面第二个参数是一个函数，函数返回值，作为 ref 对象获取的内容。一起看一下 useImperativeHandle 的基本使用。</p> <p>useImperativeHandle 接受三个参数：</p> <p>第一个参数 ref : 接受 forWardRef 传递过来的 ref 。
第二个参数 createHandle ：处理函数，返回值作为暴露给父组件的 ref 对象。
第三个参数 deps :依赖项 deps，依赖项更改形成新的 ref 对象。</p> <p><img src="https://pub-a953275fa2c34c18b80fc1f84e3ea746.r2.dev/xiaowo/2024/06/7b64df2ff8db6d0e6dbf1cac73721761.png" alt=""></p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token comment">// 子组件</span>
<span class="token keyword">function</span> <span class="token function">Son</span><span class="token punctuation">(</span><span class="token parameter">props<span class="token punctuation">,</span> ref</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> inputRef <span class="token operator">=</span> <span class="token function">useRef</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>inputValue<span class="token punctuation">,</span> setInputValue<span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token function">useState</span><span class="token punctuation">(</span><span class="token string">&quot;&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token function">useImperativeHandle</span><span class="token punctuation">(</span>
    ref<span class="token punctuation">,</span>
    <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">{</span>
      <span class="token keyword">const</span> handleRefs <span class="token operator">=</span> <span class="token punctuation">{</span>
        <span class="token function">onFocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">/* 声明方法用于聚焦input框 */</span>
          inputRef<span class="token punctuation">.</span>current<span class="token punctuation">.</span><span class="token function">focus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
        <span class="token function">onChangeValue</span><span class="token punctuation">(</span><span class="token parameter">value</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
          <span class="token comment">/* 声明方法用于改变input的值 */</span>
          <span class="token function">setInputValue</span><span class="token punctuation">(</span>value<span class="token punctuation">)</span><span class="token punctuation">;</span>
        <span class="token punctuation">}</span><span class="token punctuation">,</span>
      <span class="token punctuation">}</span><span class="token punctuation">;</span>
      <span class="token keyword">return</span> handleRefs<span class="token punctuation">;</span>
    <span class="token punctuation">}</span><span class="token punctuation">,</span>
    <span class="token punctuation">[</span><span class="token punctuation">]</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>input placeholder<span class="token operator">=</span><span class="token string">&quot;请输入内容&quot;</span> ref<span class="token operator">=</span><span class="token punctuation">{</span>inputRef<span class="token punctuation">}</span> value<span class="token operator">=</span><span class="token punctuation">{</span>inputValue<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token keyword">const</span> ForwarSon <span class="token operator">=</span> <span class="token function">forwardRef</span><span class="token punctuation">(</span>Son<span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token comment">// 父组件</span>
<span class="token keyword">class</span> <span class="token class-name">Index</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
  cur <span class="token operator">=</span> <span class="token keyword">null</span><span class="token punctuation">;</span>
  <span class="token function">handerClick</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">const</span> <span class="token punctuation">{</span> onFocus<span class="token punctuation">,</span> onChangeValue <span class="token punctuation">}</span> <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>cur<span class="token punctuation">;</span>
    <span class="token function">onFocus</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 让子组件的输入框获取焦点</span>
    <span class="token function">onChangeValue</span><span class="token punctuation">(</span><span class="token string">&quot;let us learn React!&quot;</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">// 让子组件input</span>
  <span class="token punctuation">}</span>
  <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token punctuation">(</span>
      <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> <span class="token literal-property property">marginTop</span><span class="token operator">:</span> <span class="token string">&quot;50px&quot;</span> <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>ForwarSon ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">cur</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>cur <span class="token operator">=</span> cur<span class="token punctuation">)</span><span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>button onClick<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">handerClick</span><span class="token punctuation">.</span><span class="token function">bind</span><span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">)</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>操控子组件<span class="token operator">&lt;</span><span class="token operator">/</span>button<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
    <span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre></div><h2 id="逻辑流程图"><a href="#逻辑流程图" class="header-anchor">#</a> 逻辑流程图</h2> <p><img src="https://pub-a953275fa2c34c18b80fc1f84e3ea746.r2.dev/xiaowo/2024/06/6036e881bb8bb7fdcb4380c1f5a694aa.png" alt=""></p> <h1 id="context"><a href="#context" class="header-anchor">#</a> Context</h1> <p>提供者 Provider 的用法。</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> ThemeContext <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">createContext</span><span class="token punctuation">(</span><span class="token keyword">null</span><span class="token punctuation">)</span><span class="token punctuation">;</span> <span class="token comment">//</span>
<span class="token keyword">const</span> ThemeProvider <span class="token operator">=</span> ThemeContext<span class="token punctuation">.</span>Provider<span class="token punctuation">;</span> <span class="token comment">//提供者</span>
<span class="token keyword">const</span> ThemeConsumer <span class="token operator">=</span> ThemeContext<span class="token punctuation">.</span>Consumer<span class="token punctuation">;</span> <span class="token comment">// 订阅消费者</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">ProviderDemo</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">[</span>contextValue<span class="token punctuation">,</span> setContextValue<span class="token punctuation">]</span> <span class="token operator">=</span> React<span class="token punctuation">.</span><span class="token function">useState</span><span class="token punctuation">(</span><span class="token punctuation">{</span>
    <span class="token literal-property property">color</span><span class="token operator">:</span> <span class="token string">&quot;#ccc&quot;</span><span class="token punctuation">,</span>
    <span class="token literal-property property">background</span><span class="token operator">:</span> <span class="token string">&quot;pink&quot;</span><span class="token punctuation">,</span>
  <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>ThemeProvider value<span class="token operator">=</span><span class="token punctuation">{</span>contextValue<span class="token punctuation">}</span><span class="token operator">&gt;</span>
        <span class="token operator">&lt;</span>Son <span class="token operator">/</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span><span class="token operator">/</span>ThemeProvider<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div><p>消费者 Consumer 三种用法</p> <ol><li><p>类组卷 <code>this.context</code></p></li> <li><p>函数组件 <code>useContext(ThemeContext)</code></p></li> <li><p>Consumer 方式</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">const</span> ThemeConsumer <span class="token operator">=</span> ThemeContext<span class="token punctuation">.</span>Consumer<span class="token punctuation">;</span> <span class="token comment">// 订阅消费者</span>

<span class="token keyword">function</span> <span class="token function">ConsumerDemo</span><span class="token punctuation">(</span><span class="token parameter">props</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">const</span> <span class="token punctuation">{</span> color<span class="token punctuation">,</span> background <span class="token punctuation">}</span> <span class="token operator">=</span> props<span class="token punctuation">;</span>
  <span class="token keyword">return</span> <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span> color<span class="token punctuation">,</span> background <span class="token punctuation">}</span><span class="token punctuation">}</span><span class="token operator">&gt;</span>消费者<span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>

<span class="token comment">// 将 context 内容转化成 props</span>
<span class="token keyword">const</span> <span class="token function-variable function">Son</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>ThemeConsumer<span class="token operator">&gt;</span>
    <span class="token punctuation">{</span><span class="token punctuation">(</span><span class="token parameter">contextValue</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token operator">&lt;</span>ConsumerDemo <span class="token punctuation">{</span><span class="token operator">...</span>contextValue<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">&gt;</span><span class="token punctuation">}</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>ThemeConsumer<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li></ol> <h1 id="模块化-css"><a href="#模块化-css" class="header-anchor">#</a> 模块化 CSS</h1> <ol><li><p>CSS Modules</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> style <span class="token keyword">from</span> <span class="token string">&quot;./style.css&quot;</span><span class="token punctuation">;</span>
<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=&gt;</span> <span class="token punctuation">(</span>
  <span class="token operator">&lt;</span>div<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span>div className<span class="token operator">=</span><span class="token punctuation">{</span>style<span class="token punctuation">.</span>text<span class="token punctuation">}</span><span class="token operator">&gt;</span>验证 css modules <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre></div></li> <li><p>CSS IN JS</p> <div class="language-js extra-class"><pre class="language-js"><code><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">&quot;react&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">import</span> Style <span class="token keyword">from</span> <span class="token string">&quot;./style&quot;</span><span class="token punctuation">;</span>

<span class="token keyword">export</span> <span class="token keyword">default</span> <span class="token keyword">function</span> <span class="token function">Index</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
  <span class="token keyword">return</span> <span class="token punctuation">(</span>
    <span class="token operator">&lt;</span>div style<span class="token operator">=</span><span class="token punctuation">{</span>Style<span class="token punctuation">.</span>boxStyle<span class="token punctuation">}</span><span class="token operator">&gt;</span>
      <span class="token operator">&lt;</span>span style<span class="token operator">=</span><span class="token punctuation">{</span>Style<span class="token punctuation">.</span>textStyle<span class="token punctuation">}</span><span class="token operator">&gt;</span>hi <span class="token punctuation">,</span> i am <span class="token constant">CSS</span> <span class="token constant">IN</span> <span class="token constant">JS</span><span class="token operator">!</span><span class="token operator">&lt;</span><span class="token operator">/</span>span<span class="token operator">&gt;</span>
    <span class="token operator">&lt;</span><span class="token operator">/</span>div<span class="token operator">&gt;</span>
  <span class="token punctuation">)</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre></div></li></ol> <h1 id="hoc"><a href="#hoc" class="header-anchor">#</a> HOC</h1> <p>HOC 的产生根本作用就是解决大量的代码复用，逻辑复用问题。、</p> <p><strong>那么具体复用了哪些逻辑呢？</strong></p> <ul><li>本质上是对渲染的控制，对渲染的控制可不仅仅指是否渲染组件，还可以像 dva 中 dynamic 那样懒加载/动态加载组件。</li> <li>还有一种场景，比如项目中想让一个非 Route 组件，也能通过 props 获取路由实现跳转，但是不想通过父级路由组件层层绑定 props ，这个时候就需要一个 HOC 把改变路由的 history 对象混入 props 中，于是 withRoute 诞生了。所以 HOC 还有一个重要的作用就是让 props 中混入一些你需要的东西。</li> <li>还有一种情况，如果不想改变组件，只是监控组件的内部状态，对组件做一些赋能，HOC 也是一个不错的选择，比如对组件内的点击事件做一些监控</li></ul> <p><img src="https://pub-a953275fa2c34c18b80fc1f84e3ea746.r2.dev/xiaowo/2024/06/57dcf0d30f47d3b1d2e0f5d842c799c2.png" alt=""></p> <p>下面对 HOC 具体能实现那些功能，和如何编写做一下总结：</p> <ol><li>强化 props ，可以通过 HOC ，向原始组件混入一些状态。</li> <li>渲染劫持，可以利用 HOC ，动态挂载原始组件，还可以先获取原始组件的渲染树，进行可控性修改。</li> <li>可以配合 import 等 api ，实现动态加载组件，实现代码分割，加入 loading 效果。</li> <li>可以通过 ref 来获取原始组件实例，操作实例下的属性和方法。</li> <li>可以对原始组件做一些事件监听，错误监控等。</li></ol></div> <footer class="page-edit"><!----> <!----></footer> <!----> </main></div><div class="global-ui"></div></div>
    <script src="/vuepress/assets/js/app.40312837.js" defer></script><script src="/vuepress/assets/js/2.cf1e524c.js" defer></script><script src="/vuepress/assets/js/31.11915659.js" defer></script>
  </body>
</html>
