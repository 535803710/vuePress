(window.webpackJsonp=window.webpackJsonp||[]).push([[51],{466:function(t,e,r){"use strict";r.r(e);var v=r(62),a=Object(v.a)({},(function(){var t=this,e=t.$createElement,r=t._self._c||e;return r("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[r("p",[t._v("在工作中我们经常遇到需要监听页面中元素位置，当元素超出显示区域或即将显示到页面上，我们就可以做一些动画或者操作。最常见的操作比如预加载，懒加载，TAB滚动跟随。")]),t._v(" "),r("h1",{attrs:{id:"目录"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#目录"}},[t._v("#")]),t._v(" 目录")]),t._v(" "),r("ul",[r("li",[r("code",[t._v("Intersection Observer")]),t._v(" 在MDN上的介绍")]),t._v(" "),r("li",[t._v("小程序中 "),r("code",[t._v("IntersectionObserver")]),t._v(" 的使用")])]),t._v(" "),r("h1",{attrs:{id:"实现效果"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#实现效果"}},[t._v("#")]),t._v(" 实现效果")]),t._v(" "),r("p",[r("img",{attrs:{src:"https://pub-a953275fa2c34c18b80fc1f84e3ea746.r2.dev/xiaowo/2023/08/95d9c70d3fd4a0ec00c44b1fb028c2d8.gif",alt:"intersection.gif"}})]),t._v(" "),r("p",[t._v("在浏览器的情况下，我们可以使用 "),r("code",[t._v("Intersection Observer")])]),t._v(" "),r("h1",{attrs:{id:"下面是intersection-observer在mdn上的介绍"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#下面是intersection-observer在mdn上的介绍"}},[t._v("#")]),t._v(" 下面是"),r("code",[t._v("Intersection Observer")]),t._v("在MDN上的介绍")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Web/API/IntersectionObserver",target:"_blank",rel:"noopener noreferrer"}},[t._v("MDN链接"),r("OutboundLink")],1)]),t._v(" "),r("p",[r("code",[t._v("IntersectionObserver")]),r("strong",[t._v("接口")]),t._v(" (从属于"),r("a",{attrs:{href:"https://developer.mozilla.org/en-US/docs/Web/API/Intersection_Observer_API",target:"_blank",rel:"noopener noreferrer"}},[t._v("Intersection Observer API"),r("OutboundLink")],1),t._v(") 提供了一种异步观察目标元素与其祖先元素或顶级文档视窗("),r("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Glossary/Viewport",target:"_blank",rel:"noopener noreferrer"}},[t._v("viewport"),r("OutboundLink")],1),t._v(")交叉状态的方法。祖先元素与视窗("),r("a",{attrs:{href:"https://developer.mozilla.org/zh-CN/docs/Glossary/Viewport",target:"_blank",rel:"noopener noreferrer"}},[t._v("viewport"),r("OutboundLink")],1),t._v(")被称为"),r("strong",[t._v("根(root)。")])]),t._v(" "),r("p",[t._v("当一个"),r("code",[t._v("IntersectionObserver")]),t._v("对象被创建时，其被配置为监听根中一段给定比例的可见区域。一旦IntersectionObserver被创建，则无法更改其配置，所以一个给定的观察者对象只能用来监听可见区域的特定变化值；然而，你可以在同一个观察者对象中配置监听多个目标元素。")]),t._v(" "),r("p",[r("strong",[t._v("简单来说，就是我们能不能看到想要观察的对象。")])]),t._v(" "),r("p",[t._v("在网页中，我们很容易就可以用实现Intersection Observer，而在小程序中，我们需要再多掌握一点知识。")]),t._v(" "),r("h1",{attrs:{id:"intersectionobserver"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#intersectionobserver"}},[t._v("#")]),t._v(" IntersectionObserver")]),t._v(" "),r("p",[r("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/api/wxml/IntersectionObserver.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("小程序中"),r("code",[t._v("IntersectionObserver")]),t._v("的文档地址"),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("IntersectionObserver 对象，用于推断某些节点是否可以被用户看见、有多大比例可以被用户看见。")]),t._v(" "),r("p",[r("img",{attrs:{src:"https://pub-a953275fa2c34c18b80fc1f84e3ea746.r2.dev/xiaowo/2023/08/4cd325e6b87d4d29a3869bc13baa266f.png",alt:""}})]),t._v(" "),r("h2",{attrs:{id:"relativetoviewport"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#relativetoviewport"}},[t._v("#")]),t._v(" relativeToViewport")]),t._v(" "),r("p",[t._v("指定页面显示区域作为参照区域之一")]),t._v(" "),r("div",{staticClass:"language- extra-class"},[r("pre",{pre:!0,attrs:{class:"language-text"}},[r("code",[t._v("Page({\n  onLoad: function(){\n    wx.createIntersectionObserver().relativeToViewport({bottom: 100}).observe('.target-class', (res) => {\n      res.intersectionRatio // 相交区域占目标节点的布局区域的比例\n      res.intersectionRect // 相交区域\n      res.intersectionRect.left // 相交区域的左边界坐标\n      res.intersectionRect.top // 相交区域的上边界坐标\n      res.intersectionRect.width // 相交区域的宽度\n      res.intersectionRect.height // 相交区域的高度\n    })\n  }\n})\n")])])]),r("h3",{attrs:{id:"接受参数-object-margins"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#接受参数-object-margins"}},[t._v("#")]),t._v(" 接受参数 Object margins")]),t._v(" "),r("p",[t._v("用来扩展（或收缩）参照节点布局区域的边界")]),t._v(" "),r("table",[r("thead",[r("tr",[r("th",[t._v("属性")]),t._v(" "),r("th",[t._v("类型")]),t._v(" "),r("th",[t._v("默认值")]),t._v(" "),r("th",[t._v("必填")]),t._v(" "),r("th",[t._v("说明")])])]),t._v(" "),r("tbody",[r("tr",[r("td",[t._v("left")]),t._v(" "),r("td",[t._v("number")]),t._v(" "),r("td"),t._v(" "),r("td",[t._v("否")]),t._v(" "),r("td",[t._v("节点布局区域的左边界")])]),t._v(" "),r("tr",[r("td",[t._v("right")]),t._v(" "),r("td",[t._v("number")]),t._v(" "),r("td"),t._v(" "),r("td",[t._v("否")]),t._v(" "),r("td",[t._v("节点布局区域的右边界")])]),t._v(" "),r("tr",[r("td",[t._v("top")]),t._v(" "),r("td",[t._v("number")]),t._v(" "),r("td"),t._v(" "),r("td",[t._v("否")]),t._v(" "),r("td",[t._v("节点布局区域的上边界")])]),t._v(" "),r("tr",[r("td",[t._v("bottom")]),t._v(" "),r("td",[t._v("number")]),t._v(" "),r("td"),t._v(" "),r("td",[t._v("否")]),t._v(" "),r("td",[t._v("节点布局区域的下边界")])])])]),t._v(" "),r("h2",{attrs:{id:"observe-string-targetselector-function-callback"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#observe-string-targetselector-function-callback"}},[t._v("#")]),t._v(" observe(string targetSelector, function callback)")]),t._v(" "),r("h5",{attrs:{id:"参数"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#参数"}},[t._v("#")]),t._v(" 参数")]),t._v(" "),r("p",[t._v("(targetSelector:string，callback:function)")]),t._v(" "),r("h5",{attrs:{id:"object-res"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#object-res"}},[t._v("#")]),t._v(" Object res")]),t._v(" "),r("table",[r("thead",[r("tr",[r("th",[t._v("属性")]),t._v(" "),r("th",[t._v("类型")]),t._v(" "),r("th",[t._v("说明")])])]),t._v(" "),r("tbody",[r("tr",[r("td",[t._v("id")]),t._v(" "),r("td",[t._v("string")]),t._v(" "),r("td",[t._v("节点 ID")])]),t._v(" "),r("tr",[r("td",[t._v("dataset")]),t._v(" "),r("td",[t._v("Record.<string, any>")]),t._v(" "),r("td",[t._v("节点自定义数据属性")])]),t._v(" "),r("tr",[r("td",[t._v("intersectionRatio")]),t._v(" "),r("td",[t._v("number")]),t._v(" "),r("td",[t._v("相交比例")])]),t._v(" "),r("tr",[r("td",[t._v("intersectionRect")]),t._v(" "),r("td",[t._v("Object")]),t._v(" "),r("td",[t._v("相交区域的边界")])]),t._v(" "),r("tr",[r("td",[t._v("boundingClientRect")]),t._v(" "),r("td",[t._v("Object")]),t._v(" "),r("td",[t._v("目标边界")])]),t._v(" "),r("tr",[r("td",[t._v("relativeRect")]),t._v(" "),r("td",[t._v("Object")]),t._v(" "),r("td",[t._v("参照区域的边界")])]),t._v(" "),r("tr",[r("td",[t._v("time")]),t._v(" "),r("td",[t._v("number")]),t._v(" "),r("td",[t._v("相交检测时的时间戳")])])])]),t._v(" "),r("h1",{attrs:{id:"小程序中监听页面的其他方法"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#小程序中监听页面的其他方法"}},[t._v("#")]),t._v(" 小程序中监听页面的其他方法")]),t._v(" "),r("h2",{attrs:{id:"page-meta"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#page-meta"}},[t._v("#")]),t._v(" "),r("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/component/page-meta.html",target:"_blank",rel:"noopener noreferrer"}},[t._v(" page-meta"),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("页面属性配置节点，用于指定页面的一些属性、监听页面事件。只能是页面内的第一个节点。可以配合 "),r("code",[t._v("navigation-bar")]),t._v(" 组件一同使用。")]),t._v(" "),r("h6",{attrs:{id:""}},[r("a",{staticClass:"header-anchor",attrs:{href:"#"}},[t._v("#")])]),t._v(" "),r("h2",{attrs:{id:"scroll-view"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#scroll-view"}},[t._v("#")]),t._v(" "),r("a",{attrs:{href:"https://developers.weixin.qq.com/miniprogram/dev/component/scroll-view.html",target:"_blank",rel:"noopener noreferrer"}},[t._v("scroll-view"),r("OutboundLink")],1)]),t._v(" "),r("p",[t._v("可滚动视图区域。使用竖向滚动时，需要给 "),r("code",[t._v("scroll-view")]),t._v("一个固定高度，通过 WXSS 设置 height。组件属性的长度单位默认为px。")]),t._v(" "),r("h6",{attrs:{id:"-2"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#-2"}},[t._v("#")])]),t._v(" "),r("h1",{attrs:{id:"总结"}},[r("a",{staticClass:"header-anchor",attrs:{href:"#总结"}},[t._v("#")]),t._v(" 总结")]),t._v(" "),r("p",[t._v("在小程序中，我们可以用 "),r("code",[t._v("IntersectionObserver")]),t._v(" ，来监听页面的元素与页面交叉的距离，如此一来我们便可以在小程序中实现懒加载，预加载，动画等效果。")]),t._v(" "),r("p",[t._v("我们也可以用 "),r("code",[t._v("page-meta")]),t._v(" 和 "),r("code",[t._v("scroll-view")]),t._v(" 来实现滚动监听，具体需要结合实际场景。")])])}),[],!1,null,null,null);e.default=a.exports}}]);