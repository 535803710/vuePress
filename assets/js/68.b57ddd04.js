(window.webpackJsonp=window.webpackJsonp||[]).push([[68],{482:function(a,t,e){"use strict";e.r(t);var r=e(62),c=Object(r.a)({},(function(){var a=this,t=a.$createElement,e=a._self._c||t;return e("ContentSlotsDistributor",{attrs:{"slot-key":a.$parent.slotKey}},[e("h1",{attrs:{id:"垃圾回收机制"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#垃圾回收机制"}},[a._v("#")]),a._v(" 垃圾回收机制")]),a._v(" "),e("h2",{attrs:{id:"标记清理"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#标记清理"}},[a._v("#")]),a._v(" 标记清理")]),a._v(" "),e("p",[a._v("JavaScript 最常用的垃圾回收策略是标记清理（mark-and-sweep）。当变量进入上下文，比如在函数内部声明一个变量时，这个变量会被加上存在于上下文中的标记。而在上下文中的变量，逻辑上讲，永远不应该释放它们的内存，因为只要上下文中的代码在运行，就有可能用到它们。当变量离开上下文时，也会被加上离开上下文的标记。")]),a._v(" "),e("p",[a._v("给变量加标记的方式有很多种。比如，当变量进入上下文时，反转某一位；或者可以维护“在上下文中”和“不在上下文中”两个变量列表，可以把变量从一个列表转移到另一个列表。标记过程的实现并不重要，关键是策略。\n垃圾回收程序运行的时候，会标记内存中存储的所有变量（记住，标记方法有很多种）。然后，它会将所有在上下文中的变量，以及被在上下文中的变量引用的变量的标记去掉。在此之后再被加上标记的变量就是待删除的了，原因是任何在上下文中的变量都访问不到它们了。随后垃圾回收程序做一次内存清理，销毁带标记的所有值并收回它们的内存。")]),a._v(" "),e("p",[a._v("到了 2008 年，IE、Firefox、Opera、Chrome 和 Safari 都在自己的 JavaScript 实现中采用标记清理（或\n其变体），只是在运行垃圾回收的频率上有所差异。")]),a._v(" "),e("p",[a._v("定期执行以下“垃圾回收”步骤：")]),a._v(" "),e("ul",[e("li",[a._v("垃圾收集器找到所有的根，并“标记”（记住）它们。")]),a._v(" "),e("li",[a._v("然后它遍历并“标记”来自它们的所有引用。")]),a._v(" "),e("li",[a._v("然后它遍历标记的对象并标记 它们的 引用。所有被遍历到的对象都会被记住，以免将来再次遍历到同一个对象。")]),a._v(" "),e("li",[a._v("……如此操作，直到所有可达的（从根部）引用都被访问到。")]),a._v(" "),e("li",[a._v("没有被标记的对象都会被删除。\n用图表示")])]),a._v(" "),e("p",[e("img",{attrs:{src:"https://pub-a953275fa2c34c18b80fc1f84e3ea746.r2.dev/xiaowo/2023/08/4f4091b4fd3dedadc90cf78e4c557d02.png",alt:""}})]),a._v(" "),e("p",[e("img",{attrs:{src:"https://pub-a953275fa2c34c18b80fc1f84e3ea746.r2.dev/xiaowo/2023/08/71492b72c28e18a7376ed7a750640ff6.png",alt:""}})]),a._v(" "),e("p",[e("img",{attrs:{src:"https://pub-a953275fa2c34c18b80fc1f84e3ea746.r2.dev/xiaowo/2023/08/81751e26c1ffdf8ee4318b548596b3e3.png",alt:""}})]),a._v(" "),e("p",[e("img",{attrs:{src:"https://pub-a953275fa2c34c18b80fc1f84e3ea746.r2.dev/xiaowo/2023/08/e4404179bb75c13239fd96ba8921cd45.png",alt:""}})])])}),[],!1,null,null,null);t.default=c.exports}}]);